# Задача регрессии

Имеется датасет с объявлениями о продаже квартир в городе Новосибирске. 

В таблице всего 15000 строк, соответствующих разным квартирам, и 37 столбцов с признаками.

Предсказывается удельная стоимость квартиры (руб/кв.м).

Метрика ошибки - MdAPE - медиана модуля ошибки в процентах.

Произведена нормализация, отброшены выбросы, обучающая и тестовая выборки разделены в пропорции 3/1.

Для оценки использовалась линейная регрессия (чтобы разобраться с интерфейсом ноутбука), К-ближайшие соседи и дерево принятия решений.

После удаления выбросов: 13836 строк.

Пропущенные значения: В функциональных зонах около трети, было предпринято заполнение случайными величинами и выделение в отдельный признак.
При выделении в отдельный признак ошибка оценки стала меньше. 

Ценовая зона - несбалансированный класс, но можно объединить зоны меньше 15% в общий признак, тогда признак станет сбалансированным.

Категориальные признаки: Тип рынка и Функциональная зона.


![image](https://github.com/user-attachments/assets/549d783c-0013-46a9-9816-4908dbb4350d)
![image](https://github.com/user-attachments/assets/0644ce5d-633f-4330-afcc-56cf50468a6b)



# Результат работы модели:

MdAPE для линейной регрессии: 15.28%

MdAPE для Лассо регрессии: 15.29%

MdAPE для Ридж регрессии: 15.29%

Среднеквадратическое отклонение: 867427656.23

R-квадрат: 0.30

# K-NN:

![image](https://github.com/user-attachments/assets/7cf8e96d-f3dc-4e7b-a9bd-6dcaacbce5af)


Среднеквадратическое отклонение: 508400682.25

R-квадрат: 0.59

MdAPE на обучающих данных: 7.53%

MdAPE на тестовых данных: 8.77%

# Дерево решений:


![image](https://github.com/user-attachments/assets/6b50cefc-1725-41be-b35e-3e9a6af4ee6e)


Среднеквадратическое отклонение: 442229835.49

R-квадрат: 0.64

MdAPE на обучающих данных: 7.01%

MdAPE для дерева принятия решений: 8.20%

Лучший результат показало дерево решений, ошибка 8.2%
Худший результат - K-NN, ошибка 8.77%


# Кластеризация 

1. Метод KMeans
![image](https://github.com/user-attachments/assets/615def0d-5dcf-4462-8e94-0581c55b81b1)
Silhouette Score for KMeans: 0.2374

3. Метод DBSCAN
![image](https://github.com/user-attachments/assets/8b4a8408-272e-4e7e-831a-e498f081e82b)
Silhouette Score for DBSCAN: 0.176

4. Иерархическая кластеризация
![image](https://github.com/user-attachments/assets/65987154-0eb4-4d56-8269-dcfe4653c39d)
Silhouette Score for Agglomerative: 0.202

Лучший метод кластеризации - KMeans, DBSCAN плохо справляется из-за сложной структуры данных, иерархическая кластеризация выяыляет кластеры, схожие с методом KMeans. Коэффициент далёк от единицы, но при изменении параметров (увеличении количества кластеров больше 3) он становится только хуже.
